from typing import List
from pydantic import BaseModel

import uvicorn
import boto3
import psycopg2

from fastapi import FastAPI, UploadFile

from fastapi.middleware.cors import CORSMiddleware

S3_BUCKET_NAME = "image-recognition-1"


class PhotoModel(BaseModel):
    id: int
    photo_name: str
    photo_url: str
    is_deleted: bool

conn = psycopg2.connect(
        database="exampledb", user="docker", password="docker", host="0.0.0.0", port = "5432"
    )
cur = conn.cursor()
cur.execute("SELECT * FROM photo ORDER BY id DESC")
rows = cur.fetchall()

formatted_photos = []
for row in rows:
    formatted_photos.append(
        PhotoModel(
            id=row[0], photo_name=row[1], photo_url=row[2], is_deleted=row[3]
        )
    )